# Проектная работа "Веб-ларек"

"Web-ларёк" - это интернет-магазин с товарами для веб-разработчиков. В нём можно посмотреть каталог товаров, добавить товары в корзину и сделать заказ. 

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Ключевые типы данных.

Описание интерфейса карточки продукта
```
interface IProduct {
  id: string;
  description?: string;
  image: string;
  title: string;
  category: string;
  price: number | null;
};
```
Описание типа для карточки товара в корзине
```
type IBasketItem = Pick<IProduct, 'id' | 'title' | 'price'>;
```
Интерфейс для формы заказа
```
interface IOrderForm {
    email: string;
    phone: string;
    address: string;
}
```
Интерфейс для заказа

```
interface IOrder extends IOrderForm {
  items: string[];
  total: number;
}
```
Интерфейс для модального окна после оформления заказа

```
interface IOrderResult {
    id: string;
    total: string;
}
```

Описание типа ошибок формы

```
type FormErrors = Partial<Record<keyof IOrder, string>>;
```

Описание интерфейса для всех данных приложения

```
interface IAppState {
    catalog: IProduct[];
    basket: string[];
    preview: string | null;
    order: IOrder | null;
}
```

## Архитектура приложения

Приложение построено в соответствии с шаблоном проектирования архитектуры приложений MVP (Model-View-Presenter) и представлено тремя слоями, что обеспечивает разделение ответственности между слоями так, чтобы изменения в одном из них не влияли на другие:

- слой данных (Model) отвечает за хранение и изменение данных;
- слой представления (View) занимается отображением данных на странице;
- слой презентера (Presenter) обеспечивает взаимодействие между представлением и данными.

### Базовый код

#### Класс EventEmitter
---

Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков о наступлении события.

Поле класса:

`_events` - принимает название события и список подписчиков.

Методы класса: 

- `on` — для подписки на событие, 
- `off` - для отписки от события,
- `emit` - уведомления подписчиков о наступлении события.
- `onAll` - для подписки на все события,
- `offAll` - для отмены подписок всех подписчиков.
- `trigger` - генерирует заданное событие с заданными аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти классы будут генерировать события, не будучи при этом напрямую зависимыми от класса  EventEmitter.

#### Класс Api
---

Содержит в себе базовую логику отправки запросов серверу. В конструктор класса передаётся базовый адрес сервера и опциональный объект с заголовками запросов.

В полях класса хранятся следующие данные: 

- `baseUrl` - принимает и хранит изменяющуюся часть url-адреса.
- `options` - дополнительный параметр, который может содержать заголовки запроса.

Методы класса: 

- `handleResponse` - обработчик ответа сервера,
- `get` - выполняет GET-запрос на указанный в параметрах адрес и возвращает промис с объектом ответа от сервера,
- `post` - примнимает объект с данными, которые будут переданы в теле JSON запроса по адресу, указанному в параметрах запроса при вызове метода. По умолчанию метод определён как `POST` запрос, но может быть переопределён заданием третьего параметра при вызове (`PUT`, `DELETE`).

#### Класс Component<T>
---
 Абстрактный класс дженерик для создания компонентов пользовательского интерфейса.

 Конструктор класса `protected constructor(protected readonly container: HTMLElement)` принимает HTML-элемент контейнера, в который будет помещён компонент.
 
 Методы класса:
 - `toggleClass` - метод для переключения класса элемента,
 - `setDisabled` - метод для блокирования или разблокирования,переданного элемента в зависимости от значения state (true/false),
 - `setText` - метод для присваивания текста переданному элементу,
 - `setImage` - метод для установки изображения элемента и атрибута `alt`,
 - `render` - метод для отрисовки DOM-элемента.
 
 #### Класс Model<T>
 ---
 Абстрактный класс дженерик для расширения класса `Component<T>` и метода привязки события.

 Конструктор класса `constructor(container: HTMLElement, protected readonly events: IEvents)` принимает элемент контейнера, в который будет помещён компонент и брокер событий.

 Методы класса наследуются от класса `Component<T>`.

### Компоненты модели данных (Model)

#### Класс ApiModel
---
Класс является ключевым компонентом для работы с сетевыми запросами в проекте. Наследуется от базового класса Api.

Методы класса:
- `getProductList` - получение массива с карточками товаров от сервера,
- `getProduct` - получение карточки товара по её id,
- `orderProducts` - отправка объекта с данными заказа на сервер.

#### Класс AppState
---
Класс, описывающий состояние приложения, реализует интерфейс `IAppState`.

В полях класса хранятся следующие данные:
- `basket` - данные товара, добавленного в корзину,
- `catalog` - данные списка товаров, полученных от сервера,
- `order` - данные заказа для отправки на сервер,
- `preview` - данные товара, выбранного пользователем для просмотра,
- `formErrors` - данные ошибок полей формы.

Методы класса:
- `setProduct` - добавляет товар в корзину,
- `deletProduct` - удаляет товар из корзины,
- `clearBasket` - очищает корзину от данных пользователя,
- `setCatalog` - сохраняет коллекцию товаров, полученную от сервера,
- `setPreview` - сохраняет карточку для просмотра в модальном окне,
- `getCounter` - возвращает количество товаров в корзине,
- `getTotalPrice` - возвращает общую стоимость товаров в корзине,

### Компоненты представления (View)

#### Класс Card
---

